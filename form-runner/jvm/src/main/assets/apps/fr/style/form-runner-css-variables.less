// Copyright (C) 2025 Orbeon, Inc.
//
// This program is free software; you can redistribute it and/or modify it under the terms of the
// GNU Lesser General Public License as published by the Free Software Foundation; either version
// 2.1 of the License, or (at your option) any later version.
//
// This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
// without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
// See the GNU Lesser General Public License for more details.
//
// The full text of the license is available at http://www.gnu.org/copyleft/lesser.html

@import (reference) "form-runner-common";

.orbeon {

  // General
  --orbeon-base-background-color: white;
  --orbeon-base-border-color    : #e3e3e3; // darken(@wellBackground, 7%);

  // Base font
  --orbeon-base-font-size  : 13px;
  --orbeon-base-font-family: @frBaseFontFamily;
  --orbeon-base-color      : #333; // @grayDark, darker than Bootstrap default of #555

  // Links
  --orbeon-link-color      : #08c;
  --orbeon-link-hover-color: darken(#08c, 15%);

  // Labels
  --orbeon-label-font-size      : 1.00em; // label and .xforms-label
  --orbeon-label-font-family    : @frBaseFontFamily;
  --orbeon-label-font-weight    : 600; // Help label stand out
  --orbeon-label-color          : inherit;
  --orbeon-label-read-only-color: @minGrayText;

  // Hints
  --orbeon-hint-font-size  : smaller;
  --orbeon-hint-font-family: @frBaseFontFamily;
  --orbeon-hint-font-weight: inherit;
  --orbeon-hint-color      : @minGrayText;

  // Help
  --orbeon-help-icon-font-size         : 0.86em;
  --orbeon-help-icon-color             : black;
  --orbeon-help-font-family            : @frBaseFontFamily;
  --orbeon-help-background-color       : white;
  --orbeon-help-border-color           : rgba(0, 0, 0, 0.2);
  --orbeon-help-content-font-size      : 1.00em;
  --orbeon-help-content-font-weight    : inherit;
  --orbeon-help-content-color          : inherit;
  --orbeon-help-title-font-size        : 1.08em;
  --orbeon-help-title-font-weight      : inherit;
  --orbeon-help-title-color            : inherit;
  --orbeon-help-title-background-color : #f7f7f7;
  --orbeon-help-title-border-color     : #ebebeb;
  --orbeon-help-close-color            : black;
  --orbeon-help-close-text-shadow-color: rgba(255,255,255,1);

  // Controls
  --orbeon-control-font-size                 : inherit;
  --orbeon-control-font-family               : @frBaseFontFamily;
  --orbeon-control-font-weight               : inherit;
  --orbeon-control-color                     : black;   // Make text inside the fields stand out, as this is the most important information
  --orbeon-control-background-color          : white;
  --orbeon-control-read-only-background-color: #f2f2f2; // darken(@inputBackground, 5%);
  --orbeon-control-border-color              : #ccc;    // Slightly darker than base border color
  @media (prefers-contrast: more) {
    --orbeon-control-border-color            : #949494;
  }

  // Specific controls
  --orbeon-add-on-color                                    : inherit;
  --orbeon-add-on-background-color                         : #eee;
  --orbeon-add-on-text-shadow-color                        : white;
  --orbeon-dropdown-selected-background-color              : #ddd;
  --orbeon-attachment-drop-color                           : @minGrayText;
  --orbeon-attachment-dragover-color                       : white;
  --orbeon-attachment-dragover-background-color            : #ccc;
  --orbeon-handwritten-signature-background-color          : white;
  --orbeon-handwritten-signature-read-only-background-color: #eee;
  --orbeon-image-attachment-background-color               : #eee;

  // Focus
  --orbeon-focus-border-color   : #3396ff; // Blueish
  --orbeon-focus-highlight-color: rgba(0,123,255,.25);

  // Buttons
  --orbeon-button-font-size                         : 1.00em; // button and .btn
  --orbeon-button-font-family                       : @frBaseFontFamily;
  --orbeon-button-font-weight                       : normal;
  --orbeon-button-color                             : inherit;
  --orbeon-button-background-color                  : #e8e8e8; // darken(@wellBackground, 5%)
  --orbeon-button-highlight-background-color        : #e8e8e8; // darken(@wellBackground, 5%)
  --orbeon-button-primary-color                     : white;
  --orbeon-button-primary-background-color          : @btnPrimaryBackground;
  --orbeon-button-primary-highlight-background-color: @btnPrimaryBackgroundHighlight;
  --orbeon-button-warning-color                     : white;
  --orbeon-button-warning-background-color          : @btnWarningBackground;
  --orbeon-button-warning-highlight-background-color: @btnWarningBackgroundHighlight;
  --orbeon-button-danger-color                      : white;
  --orbeon-button-danger-background-color           : @btnDangerBackground;
  --orbeon-button-danger-highlight-background-color : @btnDangerBackgroundHighlight;
  --orbeon-button-success-color                     : white;
  --orbeon-button-success-background-color          : @btnSuccessBackground;
  --orbeon-button-success-highlight-background-color: @btnSuccessBackgroundHighlight;
  --orbeon-button-info-color                        : white;
  --orbeon-button-info-background-color             : @btnInfoBackground;
  --orbeon-button-info-highlight-background-color   : @btnInfoBackgroundHighlight;
  --orbeon-button-inverse-color                     : white;
  --orbeon-button-inverse-background-color          : @btnInverseBackground;
  --orbeon-button-inverse-highlight-background-color: @btnInverseBackgroundHighlight;

  // Dropdowns
  --orbeon-dropdown-open-toggle-background-color            : #e6e6e6;
  --orbeon-dropdown-item-background-color                   : #e8e8e8;
  --orbeon-dropdown-item-highlight-background-color         : #0081c2;
  --orbeon-dropdown-item-disabled-highlight-background-color: transparent;

  // Sections
  --orbeon-section-title-font-size              : 1.38em;  // 18px
  --orbeon-section-repetition-label-font-size   : 0.89em;  // 18px * 0.8 * 0.8
  --orbeon-subsection-title-font-size           : 1.11em;  // 18px * 0.8
  --orbeon-subsection-repetition-label-font-size: 0.89em;  // 18px * 0.8 * 0.8
  --orbeon-section-font-family                  : @frBaseFontFamily;
  --orbeon-section-font-weight                  : normal;
  --orbeon-section-color                        : #555;
  --orbeon-section-background-color             : #eee;    // @grayLighter;
  --orbeon-repeater-add-button-font-size        : 1.00em;
  --orbeon-repeater-add-button-font-family      : inherit;
  --orbeon-repeater-add-button-font-weight      : inherit;
  --orbeon-repeater-add-button-color            : inherit;
  --orbeon-repeat-menu-background-color         : #f5f5f5; // @wellBackground

  // Grids
  --orbeon-repetition-number-font-size         : smaller;
  --orbeon-repetition-number-font-family       : inherit;
  --orbeon-repetition-number-font-weight       : bold;
  --orbeon-repetition-number-color             : white;
  --orbeon-repetition-number-background-color  : #999;
  --orbeon-repetition-selected-background-color: #eee; // @grayLighter

  // Regular and wizard table of contents (TOC)
  --orbeon-toc-color                          : #0d6efd;
  --orbeon-toc-background-color               : white;
  --orbeon-toc-hover-background-color         : #eee; // @grayLighter;
  --orbeon-toc-selected-color                 : white;
  --orbeon-toc-selected-background-color      : #0d6efd;
  --orbeon-toc-error-color                    : @error;
  --orbeon-toc-error-background-color         : transparent;
  --orbeon-toc-selected-error-color           : white;
  --orbeon-toc-selected-error-background-color: @error;

  // Navbar
  --orbeon-navbar-color            : white;
  --orbeon-navbar-background-color : rgb(33, 37, 41);         // temporary, copied from the default Bootstrap 5 theme
  --orbeon-navbar-heading-font-size: 1.54em;                  // 20px
  --orbeon-navbar-heading-color    : rgba(255, 255, 255, .5); // @frNavBarTextColor, match Bootstrap 5

  // Tables
  --orbeon-table-background-color        : white;
  --orbeon-table-striped-background-color: #f9f9f9;
  --orbeon-table-hover-background-color  : #f5f5f5;
  --orbeon-table-border-color            : #ddd;

  // HTML elements
  --orbeon-blockquote-font-size  : 1.35em; // 18px
  --orbeon-blockquote-font-family: inherit;
  --orbeon-blockquote-font-weight: 300;
  --orbeon-blockquote-color      : inherit;
  --orbeon-code-font-size        : 0.92em; // 12px; code and CodeMirror
  --orbeon-code-font-family      : monospace;
  --orbeon-code-font-weight      : inherit;
  --orbeon-code-color            : inherit;
  --orbeon-pre-font-size         : 1.00em;
  --orbeon-pre-font-family       : monospace;
  --orbeon-pre-font-weight       : inherit;
  --orbeon-pre-color             : inherit;
  --orbeon-sub-sup-font-size     : 0.75em;

  // Icons
  --orbeon-search-caret-font-size : 0.80em;
  --orbeon-section-caret-font-size: 0.75em;
  --orbeon-dialog-icon-font-size  : 50px;
  --orbeon-fa-icon-font-size      : 0.92em; // 12px; with Font Awesome 6, fonts appear larger than with version 4, so make them smaller
  --orbeon-required-icon-font-size: 0.60em; // Font Awesome star is large

  // Alerts
  --orbeon-active-alert-font-size        : 1em; // TODO: overridden by "inherit" when visited => useless?
  --orbeon-active-alert-font-family      : sans-serif;
  --orbeon-active-alert-font-weight      : inherit;
  --orbeon-active-alert-color            : white;
  --orbeon-alert-color                   : #555;    // @gray
  --orbeon-alert-background-color        : white;
  --orbeon-alert-border-color            : #e3e3e3; // darken(@wellBackground, 7%);
  --orbeon-alert-text-shadow-color       : rgba(255,255,255,.5);
  --orbeon-alert-error-color             : #842029;
  --orbeon-alert-error-background-color  : #f8d7da;
  --orbeon-alert-error-border-color      : #f5c2c7;
  --orbeon-alert-success-color           : #0f5132;
  --orbeon-alert-success-background-color: #d1e7dd;
  --orbeon-alert-success-border-color    : #badbcc;
  --orbeon-alert-warning-color           : #664d03;
  --orbeon-alert-warning-background-color: #fff3cd;
  --orbeon-alert-warning-border-color    : #ffecb5;

  // Errors and error summary
  --orbeon-error-summary-title-color              : white;
  --orbeon-error-summary-title-bottom-border-color: #e5e5e5;
  --orbeon-error-summary-item-background-color    : white;
  --orbeon-info-color                             : @info;
  --orbeon-warning-color                          : @warning;
  --orbeon-error-color                            : @error;

  // Required icon (left)
  --orbeon-required-icon-display-before: inline;
  --orbeon-required-icon-display-after : none;

  /*
  // Required icon (right)
  --orbeon-required-icon-display-before: none;
  --orbeon-required-icon-display-after : inline;
  */

  --orbeon-dialog-title-font-size               : 1.11em; // 2022-12-11: larger font size for dialog title looks better
  --orbeon-header-footer-font-size              : 1.10em;
  --orbeon-kbd-hint-font-size                   : 0.82em; // 8pt
  --orbeon-revision-history-pane-title-font-size: 1.11em;

  // Headings
  --orbeon-h1-font-size: 2.96em; // 38px = 296% * 13px = 275% * 14px
  --orbeon-h2-font-size: 2.42em; // 32px = 242% * 13px = 225% * 14px
  --orbeon-h3-font-size: 1.88em; // 24px = 188% * 13px = 175% * 14px
  --orbeon-h4-font-size: 1.35em; // 18px = 135% * 13px = 125% * 14px
  --orbeon-h5-font-size: 1.08em; // 14px = 108% * 13px = 100% * 14px
  --orbeon-h6-font-size: 0.92em; // 12px =  92% * 13px =  85% * 14px

  // Tooltips (e.g. tabs tooltips)
  --orbeon-tooltip-font-size       : 0.85em; // 11px
  --orbeon-tooltip-color           : #fff;   // @tooltipColor;
  --orbeon-tooltip-background-color: #000;   // @tooltipBackground;

  // Friendly Captcha
  --orbeon-friendly-captcha-font-size: 1.08em; // 14px

  // XForms inspector (by default, keep the font size absolute)
  --orbeon-inspector-font-size: 13px;

  // Explicit dark mode
  @media screen {
    .fr-color-scheme-dark, &:has(.fr-color-scheme-dark) {
      .dark-color-scheme()
    }
  }

  // System-preference dark mode (screen only)
  @media screen and (prefers-color-scheme: dark) {
    .fr-color-scheme-system, &:has(.fr-color-scheme-system) {
      .dark-color-scheme()
    }
  }

  .dark-color-scheme() {
    @dark        : #222;
    @bright      : #ddd;
    @desaturation: 15%;

    --orbeon-base-background-color                           : @dark;
    --orbeon-base-border-color                               : #333;
    --orbeon-base-color                                      : #ccc;
    --orbeon-label-read-only-color                           : #888;
    --orbeon-hint-color                                      : #888;
    --orbeon-help-icon-color                                 : @bright;
    --orbeon-help-background-color                           : @dark;
    --orbeon-help-border-color                               : #444;
    --orbeon-help-title-background-color                     : #333;
    --orbeon-help-title-border-color                         : #444;
    --orbeon-help-close-color                                : white;
    --orbeon-help-close-text-shadow-color                    : transparent;
    --orbeon-control-color                                   : @bright;
    --orbeon-control-background-color                        : @dark;
    --orbeon-control-read-only-background-color              : #333;
    --orbeon-control-border-color                            : #444;
    --orbeon-add-on-background-color                         : #333;
    --orbeon-add-on-text-shadow-color                        : transparent;
    --orbeon-dropdown-selected-background-color              : #444;
    --orbeon-attachment-drop-color                           : #aaa;
    --orbeon-attachment-dragover-color                       : @dark;
    --orbeon-attachment-dragover-background-color            : #444;
    --orbeon-handwritten-signature-background-color          : #eee;
    --orbeon-handwritten-signature-read-only-background-color: #ccc;
    --orbeon-image-attachment-background-color               : #333;
    --orbeon-button-color                                    : @bright;
    --orbeon-button-background-color                         : #aaa;
    --orbeon-button-highlight-background-color               : #aaa;
    --orbeon-button-primary-color                            : @bright;
    --orbeon-button-primary-background-color                 : desaturate(@btnPrimaryBackground, @desaturation);
    --orbeon-button-primary-highlight-background-color       : desaturate(@btnPrimaryBackgroundHighlight, @desaturation);
    --orbeon-button-warning-color                            : @bright;
    --orbeon-button-warning-background-color                 : desaturate(@btnWarningBackground, @desaturation);
    --orbeon-button-warning-highlight-background-color       : desaturate(@btnWarningBackgroundHighlight, @desaturation);
    --orbeon-button-danger-color                             : @bright;
    --orbeon-button-danger-background-color                  : desaturate(@btnDangerBackground, @desaturation);
    --orbeon-button-danger-highlight-background-color        : desaturate(@btnDangerBackgroundHighlight, @desaturation);
    --orbeon-button-success-color                            : @bright;
    --orbeon-button-success-background-color                 : desaturate(@btnSuccessBackground, @desaturation);
    --orbeon-button-success-highlight-background-color       : desaturate(@btnSuccessBackgroundHighlight, @desaturation);
    --orbeon-button-info-color                               : @bright;
    --orbeon-button-info-background-color                    : desaturate(@btnInfoBackground, @desaturation);
    --orbeon-button-info-highlight-background-color          : desaturate(@btnInfoBackgroundHighlight, @desaturation);
    --orbeon-button-inverse-color                            : @bright;
    --orbeon-button-inverse-background-color                 : desaturate(@btnInverseBackground, @desaturation);
    --orbeon-button-inverse-highlight-background-color       : desaturate(@btnInverseBackgroundHighlight, @desaturation);
    --orbeon-dropdown-open-toggle-background-color           : #aaa;
    --orbeon-section-color                                   : #bbb;
    --orbeon-section-background-color                        : #333;
    --orbeon-repeater-add-button-color                       : @dark;
    --orbeon-repeat-menu-background-color                    : #2a2a2a;
    --orbeon-repetition-number-color                         : @dark;
    --orbeon-repetition-number-background-color              : #666;
    --orbeon-repetition-selected-background-color            : #444;
    --orbeon-toc-color                                       : #4493f8;
    --orbeon-toc-background-color                            : @dark;
    --orbeon-toc-hover-background-color                      : #333;
    --orbeon-toc-selected-color                              : @dark;
    --orbeon-toc-selected-background-color                   : #4493f8;
    --orbeon-toc-error-color                                 : desaturate(@error, @desaturation);
    --orbeon-toc-selected-error-color                        : @dark;
    --orbeon-toc-selected-error-background-color             : desaturate(@error, @desaturation);
    --orbeon-navbar-background-color                         : #020408;
    --orbeon-table-background-color                          : @dark;
    --orbeon-table-striped-background-color                  : #2e2e2e;
    --orbeon-table-hover-background-color                    : #4a4a4a;
    --orbeon-table-border-color                              : #3a3a4a;
    --orbeon-active-alert-color                              : @dark;
    --orbeon-alert-color                                     : #aaa;
    --orbeon-alert-background-color                          : @dark;
    --orbeon-alert-border-color                              : #333;
    --orbeon-alert-text-shadow-color                         : transparent;
    --orbeon-alert-error-color                               : desaturate(#842029, @desaturation);
    --orbeon-alert-error-background-color                    : desaturate(#f8d7da, @desaturation);
    --orbeon-alert-error-border-color                        : desaturate(#f5c2c7, @desaturation);
    --orbeon-alert-success-color                             : desaturate(#0f5132, @desaturation);
    --orbeon-alert-success-background-color                  : desaturate(#d1e7dd, @desaturation);
    --orbeon-alert-success-border-color                      : desaturate(#badbcc, @desaturation);
    --orbeon-alert-warning-color                             : desaturate(#664d03, @desaturation);
    --orbeon-alert-warning-background-color                  : desaturate(#fff3cd, @desaturation);
    --orbeon-alert-warning-border-color                      : desaturate(#ffecb5, @desaturation);
    --orbeon-error-summary-title-color                       : @bright;
    --orbeon-error-summary-title-bottom-border-color         : transparent;
    --orbeon-error-summary-item-background-color             : @dark;
    --orbeon-info-color                                      : #307395;
    --orbeon-warning-color                                   : #c1861a;
    --orbeon-error-color                                     : #a65c5b;
  }
}

@media print {
  .orbeon {
    // For CSS debugging with "Preview" and the relevant .fr-pdf-color-mode-* classes
    &:has(.fr-pdf-color-mode-black-and-white), &:has(.fr-pdf-color-mode-keep-field-colors) {
      // Use !important instead of more complex selectors to win over .orbeon:not(:has(.fb-main)), etc.
      --orbeon-base-background-color: white !important;
    }

    &, .fr-pdf-color-mode-black-and-white, .fr-pdf-color-mode-keep-field-colors {
      --orbeon-base-background-color                           : white;
      --orbeon-base-border-color                               : #e3e3e3;
      --orbeon-base-color                                      : black;
      --orbeon-control-read-only-background-color              : white;
      --orbeon-control-border-color                            : #ccc;
      --orbeon-handwritten-signature-read-only-background-color: white;
      --orbeon-section-color                                   : black;
      --orbeon-section-background-color                        : white;
      --orbeon-repeat-menu-background-color                    : white;
      --orbeon-toc-color                                       : black;
      --orbeon-navbar-background-color                         : white;
      --orbeon-navbar-heading-font-size                        : 1.85em;
      --orbeon-navbar-heading-color                            : black;
      --orbeon-alert-color                                     : black;
      --orbeon-alert-background-color                          : white;
      --orbeon-alert-border-color                              : #e3e3e3;
      --orbeon-alert-error-color                               : black;
      --orbeon-alert-error-background-color                    : white;
      --orbeon-alert-error-border-color                        : #f5c2c7;
      --orbeon-alert-success-color                             : black;
      --orbeon-alert-success-background-color                  : white;
      --orbeon-alert-success-border-color                      : #badbcc;
      --orbeon-alert-warning-color                             : black;
      --orbeon-alert-warning-background-color                  : white;
      --orbeon-alert-warning-border-color                      : #ffecb5;
    }
  }
}
