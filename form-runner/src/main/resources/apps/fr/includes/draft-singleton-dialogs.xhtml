<!--
  Copyright (C) 2013 Orbeon, Inc.

  This program is free software; you can redistribute it and/or modify it under the terms of the
  GNU Lesser General Public License as published by the Free Software Foundation; either version
  2.1 of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  See the GNU Lesser General Public License for more details.

  The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
  -->
<xh:div xmlns:xh="http://www.w3.org/1999/xhtml"
          xmlns:xf="http://www.w3.org/2002/xforms"
          xmlns:xxf="http://orbeon.org/oxf/xml/xforms"
          xmlns:fr="http://orbeon.org/oxf/xml/form-runner">

    <xxf:dialog id="found-draft-for-document" level="modal" close="false" draggable="true" class="fr-dialog">
        <xf:label ref="$fr-resources/detail/draft-singleton/found-draft"/>
        <xh:div>
            <xh:img src="/apps/fr/style/images/pixelmixer/bubble_64.png" alt="" class="fr-dialog-icon"/>
            <xh:div class="fr-dialog-message">
                <xf:output value="$fr-resources/detail/draft-singleton/found-draft-for-document"/>
            </xh:div>
        </xh:div>
        <xh:div class="fr-dialog-buttons">
            <xf:group>
                <xxf:hide event="DOMActivate" dialog="found-draft-for-document"/>
                <xf:trigger>
                    <xf:label value="$fr-resources/detail/draft-singleton/open-saved"/>
                    <xf:send event="DOMActivate" submission="fr-get-document-submission">
                        <xf:property name="data-or-draft" value="'data'"/>
                    </xf:send>
                </xf:trigger>
                <xf:trigger>
                    <xf:label value="$fr-resources/detail/draft-singleton/open-draft"/>
                    <xf:send event="DOMActivate" submission="fr-get-document-submission">
                        <xf:property name="data-or-draft" value="'draft'"/>
                    </xf:send>
                </xf:trigger>
            </xf:group>
        </xh:div>
    </xxf:dialog>

    <xxf:dialog id="found-draft-for-never-saved" level="modal" close="false" draggable="true" class="fr-dialog">
        <xf:label ref="$fr-resources/detail/draft-singleton/found-draft"/>
        <xh:div>
            <xh:img src="/apps/fr/style/images/pixelmixer/bubble_64.png" alt="" class="fr-dialog-icon"/>
            <xh:div class="fr-dialog-message">
                <xf:output value="$fr-resources/detail/draft-singleton/found-draft-for-never-saved"/>
            </xh:div>
        </xh:div>
        <xh:div class="fr-dialog-buttons">
            <xf:group>
                <xxf:hide event="DOMActivate" dialog="found-draft-for-never-saved"/>
                <xf:trigger>
                    <xf:label value="$fr-resources/detail/draft-singleton/start-new"/>
                </xf:trigger>
                <xf:trigger>
                    <xf:label value="$fr-resources/detail/draft-singleton/open-draft"/>
                    <xf:action event="DOMActivate">
                        <xf:setvalue ref="xxf:instance('fr-parameters-instance')/document" value="xxf:instance('fr-search-response')/document/@name"/>
                        <xf:send event="DOMActivate" submission="fr-get-document-submission">
                            <xf:property name="data-or-draft" value="'draft'"/>
                        </xf:send>
                    </xf:action>
                </xf:trigger>
            </xf:group>
        </xh:div>
    </xxf:dialog>

    <xxf:dialog id="found-drafts-for-never-saved" level="modal" close="false" draggable="true" class="fr-dialog">
        <xf:label ref="$fr-resources/detail/draft-singleton/found-drafts"/>
        <xh:div>
            <xh:img src="/apps/fr/style/images/pixelmixer/bubble_64.png" alt="" class="fr-dialog-icon"/>
            <xh:div class="fr-dialog-message">
                <xf:output value="$fr-resources/detail/draft-singleton/found-drafts-for-never-saved"/>
            </xh:div>
        </xh:div>
        <xh:div class="fr-dialog-buttons">
            <xf:group>
                <xf:trigger>
                    <xf:label value="$fr-resources/detail/draft-singleton/start-new"/>
                    <xxf:hide event="DOMActivate" dialog="found-drafts-for-never-saved"/>
                </xf:trigger>
                <xf:trigger xxf:modal="true">
                    <xf:label value="$fr-resources/detail/draft-singleton/view-drafts"/>
                    <xf:load event="DOMActivate" resource="/fr/{$app}/{$form}/summary?drafts-for-never-saved-document=true" model="fr-persistence-model"/>
                </xf:trigger>
            </xf:group>
        </xh:div>
    </xxf:dialog>

    <xxf:dialog id="found-multiple-docs-for-singleton" level="modal" close="false" draggable="true" class="fr-dialog">
        <xf:label ref="$fr-resources/detail/draft-singleton/multiple-docs-title"/>
        <xh:div>
            <xh:img src="/apps/fr/style/images/pixelmixer/bubble_64.png" alt="" class="fr-dialog-icon"/>
            <xh:div class="fr-dialog-message">
                <xf:output value="$fr-resources/detail/draft-singleton/multiple-docs-explanation"/>
            </xh:div>
        </xh:div>
        <xh:div class="fr-dialog-buttons">
            <xf:group>
                <xf:trigger xxf:modal="true" appearance="xxf:primary">
                    <xf:label value="$fr-resources/detail/draft-singleton/multiple-docs-view-data"/>
                    <xf:load event="DOMActivate" resource="/fr/{$app}/{$form}/summary" model="fr-persistence-model"/>
                </xf:trigger>
            </xf:group>
        </xh:div>
    </xxf:dialog>

</xh:div>