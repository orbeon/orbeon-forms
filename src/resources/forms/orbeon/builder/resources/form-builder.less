/**
 * Copyright (C) 2010 Orbeon, Inc.
 *
 * This program is free software; you can redistribute it and/or modify it under the terms of the
 * GNU Lesser General Public License as published by the Free Software Foundation; either version
 * 2.1 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Lesser General Public License for more details.
 *
 * The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
 */

@import "../../../../apps/fr/style/form-runner-common";

@darkBlue: #004B92;
@lightBlue: #DEF;
@yellow: #ffffd3;
@fbGutter: 10px;

// Overwrite definition in form-runner-orbeon.css if any
html {
    overflow-y: scroll;
    background-color: darkgray;
    background-image: url("../../../../forms/orbeon/builder/images/low_contrast_linen_@2X.png");
}
body {
    padding-top: 0;
    margin-right: 4px;
    background-image: url("../../../../forms/orbeon/builder/images/low_contrast_linen_@2X.png");
}

.fb-main {
    position: absolute;
    top: 40px + @fbGutter;
    right: @fbGutter;
    left: 200px + @fbGutter;
    bottom: 62px;
    overflow-y: auto;

    .fb-main-inner {
        background-color: @wellBackground;
        .border-radius(6px);
        overflow: hidden;               // So navbar at the top doesn't get over the "border radius" and cancels its effect
        .box-sizing(border-box);
        margin-bottom: 0;
    }
}

.fb-bottom {
    z-index: @zindexFixedNavbar;        // put in front like the navbar
    background-color: @frBackground;
}

#fr-view fieldset, .xforms-dialog fieldset { border: 1px solid #CCCCCC; }

// TODO: Do we need this one?
.xbl-fr-section > label { display: none }

.fb-section-editor {
    position: absolute;                                                                                                 // Its left/right set in CoffeeScript relative to the current section
    display: none;                                                                                                      // Shown in CoffeeScript when mouse over section
    padding: 0 10px 20px 20px;                                                                                          // Space between icons and section, and at bottom/top in case the mouse moves a bit out
    .xforms-trigger { display: block; }                                                                                 // Icons shown vertically
}

.fb-grid-repeat-editor {                                                                                                // Section that contains the grid/repeat icons that are moved based on pointer position
    .xforms-trigger {
        display: none;                                                                                                  // Shown in CoffeeScript based on pointer position
        position: absolute;                                                                                             // Left/right set in CoffeeScript
    }
}

.fb-section-label-editor-click-interceptor {                                                                            // Shown on top of each section label to avoid click → collapse
    position: absolute;                                                                                                 // Is left/right set in CoffeeScript relative to the current section label
    cursor: pointer;
    font-size: 20px;                                                                                                    // Matching the title font size
    line-height: 40px;                                                                                                  // So text is vertically centered
    color: #BBB;                                                                                                        // Light gray denoting hint
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;                                                        // Matching font defined by Bootstrap for titles
}

.fb-edit-section-label {                                                                                                // Input created dynamically to edit section label
    position: absolute;
    z-index: 2;                                                                                                         // Display on top of click interceptor
    font-size: 20px;                                                                                                    // Same as the one on .xforms-form h2 in f-r-o.css
    box-sizing: border-box;                                                                                             // Makes relative sizing easier
}

.fr-section-title.hover {                                                                                               // .hover added by CS on mouse over click interceptor
    background-image: -webkit-linear-gradient(top, white, #DDD);                                                        // Yellow background to indicate clickable area
}

.fb-delete-grid-trigger {
    position: absolute;                                                                                                 // Its left/right set in JS relative to the current grid
    display: none;                                                                                                      // Shown in JS when mouse over grid
    padding: 0;                                                                                                         // Space between icons and grid, and at top/left in case the mouse moves a bit out
}

.fb-ie-warning { margin: 1em; padding: .5em; border: 4px solid #D00000; background-color: #FFF0F0 }

.fb-nowrap { white-space: nowrap }
.fb-xforms-disabled { display: none }
.fb-hide-alert .xforms-alert { display: none }

// This is for the form builder title at the top
.fb-top h1.fr-form-title {
    clear: none;
    color: @darkBlue;
    margin: 0 0 0 2em;
    padding: 0;
}

div.xbl-fr-grid {
    padding: 22px 0 0 22px;                                                                                             // Reserve space for icons
}

/* ***** Toolbox **************************************************************************************************** */

.fb-toolbox {
    position: fixed;
    left: @fbGutter;
    top: 40px + @fbGutter;
    bottom: 62px;
    width: 192px;
    padding: 0px;
    padding-bottom: 6px;
    overflow-y: auto;
    .box-sizing(border-box);

    .fb-toolbox-inside {
        width: 100%;
        .box-sizing(border-box);

        .fb-tools {
            .fr-border();
            padding: 8px;
            margin-bottom: @fbGutter;

            legend {
                margin-bottom: 10px;
                font-size: 12pt;
                text-indent: 4px;
                line-height: 24px;
                margin-top: -4px;
            }

            .xforms-label {
                display: block;
                margin: 1em 0 .5em 0;
                font-size: 93%;
            }

            .fb-tool {
                margin: 0 0 0 .7em;

                .xforms-trigger { display: block }                                                                      // tools to always show vertically
                .xforms-trigger button     {
                    padding: 2px 0 2px 0;
                    border: none; background: none; box-shadow: none;                                                   // remove button default styling
                    font-size: 85%;                                                                                     // smaller text next icon
                }
            }

            // Services and actions
            ul { margin: 0; overflow: auto }
            li { list-style-type: none; white-space: nowrap; font-size: 11px }
            .xforms-trigger a { text-decoration: none }
        }

        // Cut / Copy / Paste
        .fb-xvc { text-align: center }
        .fb-xvc .xforms-trigger { margin-right: .5em }

        .xbl-fr-alert-dialog {display: none }   // because w/ Chrome, a DIV of the dialog remains under the toolbox DIV and causes the toolbox to scroll

        .fr-orbeon-version { color: white; }
    }
}

/* ***** Dialogs **************************************************************************************************** */

// Metadata editor dialog
.fb-dialog-form-settings {
    width: 600px;

    img { float: left; margin: 1em 2em 0 1em; }
    .xforms-label { display: block; }
    .xforms-hint { margin-bottom: 1em; }
    .fb-dialog-form-settings-fields {
        float: left;
        width: 475px;
        input, textarea {
            width: 100%;
            box-sizing: border-box;
        }
    }

    .fb-dialog-form-settings-stats {
        th { text-align: left }
        td { text-align: right; padding-left: .5em }
        &> .xforms-label { border-bottom: 1px solid #DDE }
    }
}

// Itemset editor dialog
// Using a class instead of an id since the id is simply 'dialog' as it is declared in a component
.fb-itemset-editor-dialog {
    width: 35em;

    .fr-grid-2-columns .xforms-input input { width: 13em }
    .xbl-fr-link-select1 { margin-bottom: .5em; float: right }
    .xbl-fr-link-select1 .xforms-label { display: none }
    .xforms-invalid .xforms-input-input { border-color: #DF731B }     // show errors also for fields that aren't visited
}

// Submission editor dialog
#fb-service-dialog {
    width: 45em;
    .fb-service-dialog-error {
        border: 2px solid red; padding: .25em;
        select {
            border: none;
        }
    }
    .fb-service-dialog-success {
        border: 2px solid green;
        padding: .25em;
    }
    .fb-submission-response {
        display: block;
        height: 200px;
        overflow-y: auto;
        textarea {
            height: 10em;
        }
    }
}


// Bindings editor dialog
#fb-action-dialog {
    width: 45em;
    .xforms-select1 { width: auto }
    .fr-repeat-table {
        .fb-parameters {
            .xforms-label { display: block }
            .xforms-hint { display: block }
            .xforms-disabled { display: none }
        }
        th { white-space: nowrap }
    }
}

#fb-database-service-dialog {
    width: 45em;
    textarea {
        height: 10em;
        font-family: monospace;
    }
}


// Help dialog
#fb-edit-help-dialog {
    width: 40em;
    textarea {
        width: 98%;
        height: 12em;
    }
}

// Other dialogs
.xforms-dialog .bd { padding-left: .5em; padding-right: .5em }
.xforms-dialog .xforms-label img { vertical-align: middle }

#fb-section-details-dialog,
    #fb-add-language-dialog { width: 20em }
#dialog-control-details\$dialog .xforms-input input { width: 98% }

#dialog-control-details\$dialog {
    width: 20em;
    .xforms-input input { width: 98% }
}

#fb-edit-validation-dialog {
    width: 30em;

    textarea { width: 98%; height: 4em }
    .xforms-label { display: block; clear: both }
    .xforms-hint { display: block; clear: both }
    .xforms-disabled { display: none }
}

#fb-schema-upload-dialog {
    width: 35em;

    .xforms-hint { width: 100% }
    .xforms-select1 { height: 10em; width: 100% }
    .fb-dialog-h2 { font-size: larger; display: block; padding-top: .3em; padding-bottom: .3em }
    .fb-dialog-section { display: block; margin-left: 1em }
}

#fb-source-editor-dialog {
    width: 70em;
    .CodeMirror { font-size: 12px; }        // Pick slightly smaller font size, default being 13px
    .CodeMirror-scroll { height: auto }
    .xforms-alert-active { display: block }

    .fb-xml-dialog-view { width: 100% }
    .fb-xml-dialog-view textarea.xforms-textarea { width: 100%; height: 29em; font-family: monospace }
}

// Publish dialog
#fb-publish-dialog { width: 35em }
.fb-publish-message {
    background-color: white;
    border: 1px solid #DDDDDD;
    display: block;
    padding: .5em;
}

// Test dialog
.fb-test-dialog {
    .fb-test-iframe { width: 100%; border: 1px solid #666; }
    .xforms-trigger button { float: right; width: 9.5em }
}

// PE dialog
// NOTE: This should not be needed because alert dialog should not use label for message content
.xbl-fr-alert-dialog-message .xforms-label { font-weight: normal }

/* ***** Header ***************************************************************************************************** */

.fr-header {
    .fb-form-settings-trigger { display: inline-block; float: right; margin-left: .5em }
    .fb-language-triggers  { display: inline-block; float: right; margin-left: 1em }
}

/* ***** Top ******************************************************************************************************** */

// Title and description
.fb-top h1 {
    font-size: 25px;    // Make title larger than what it is in Form Runner (overrides 20px)
    line-height: 45px;  // Make line higher to compensate for larger font (overrides 40px)
}

/* ***** Footer ***************************************************************************************************** */

// Give height to footer so it shows up even if empty
.fr-footer div { height: 1em }

/* ***** In-Place Editing ******************************************************************************************* */

// Label and hint editors
.fr-grid .xforms-label input, .fr-grid .xforms-hint input  {
    height: @baseLineHeight;
    padding: 0;
    .box-sizing(border-box);
    .border-radius(0);
}

h2 .fr-section-label {
    height: 36px;                                                                                                       // So the title takes space even when empty; 36px is line-height in bootstrap.css
                                                                                                                        // Goes on the label, not the h2, so the collaps background image shows even when empty
}

/* ***** Misc ******************************************************************************************************* */

// Highlighting of top-level blocks (sections, ...)
.fb-top-level-content { padding-left: .5em; margin-bottom: .5em; border-left: 0 solid transparent }
.fb-top-level-content:hover { border-left: 0 solid #ccc }
.fr-section-container .xforms-repeat-selected-item-1 { border-left: 0 solid @darkBlue}

// Highlighting of section content (grids, ...)
.fb-section-content { display: block; padding-left: .5em; margin-bottom: .5em; border-left: 0 solid transparent }
.fb-section-content:hover { border-left: 0 solid #ccc}
.fr-section-container .xforms-repeat-selected-item-2 { border-left: 0 solid @darkBlue}

// Control editor
.fb-edit-label .xforms-label { display: none }
.fb-edit-label .fr-inplace-content {
    display: inline;
    margin-bottom: .2em;
}

.fb-edit-label .fr-inplace-edit .xforms-alert { display: none }

a.xforms-help-image .fb-control-help { vertical-align: baseline; }

// Would be nice to make text gray when only a hint
/*.fb-control-label .fr-inplace-content { color: gray }*/

.fb-edit-hint .fr-inplace-content {
    font-size: smaller;
    font-style: italic;
    display: block;
    margin-top: .2em;
    color: gray
}

.fr-logo .xforms-upload-mediatype, .fr-logo .xforms-upload-size, .fr-logo .xforms-upload-filename { display: none }
.fr-logo .xforms-upload-info { background-image: none; padding-left: 0 }
.fr-logo .xforms-upload-remove { padding-left: 0 }

/* ***** Grid ******************************************************************************************************* */
.fb-cell-editor { display: none } // Contains the editing markup that will be moved inside each grid td

.fr-view {
    display: block;                                                                                                     // So we can get its width in `position.coffee`
    table.fr-grid.fr-norepeat {                                                                                         // For non-repeat grid (`table` to override collapse in FR.less)
        border-collapse: collapse;
        &:hover .fr-grid-td { border: 1px solid @lightBlue }
    }
    .fr-grid-tr { height: 60px }                                                                                        // Enough space to hold row icons so hovering doesn't cause the row to expand
}

.fr-grid-td { border: 1px solid transparent }
.fr-grid.fr-norepeat:hover .fr-grid-td { border: 1px solid @lightBlue} // Only for grid which is not a repeat, e.g. no highlighting in itemset editor

.fb-grid-cell-icons, .fb-grid-control-icons, .fb-grid-row-icons {
    display: block; width: 16px;
    height: 60px;
    text-align: center }

// Grid icons and hovering
.fb-grid-top-left-td { text-align: center; width: 24px }
.fr-grid .fb-grid-top-left-td img { display: none }

// Delete, expand, shrink shown to the left of the cell
.fb-grid-cell-icons { position: absolute; left: .5em; top: .5em}
.fb-grid-cell-icons img { margin-bottom: 0; padding: 0 }
.fr-grid .fr-grid-td .fb-grid-cell-icons img { display: inline }
// Control details and validation shown to the top right of the cell
.fb-grid-control-icons { position: absolute; right: .5em; top: .5em }
.fb-grid-control-icons img { margin-bottom: 0; padding: 0 }
// Optional link to itemset editor shown to the bottom of the cell
// Position to the left (2.5em) matched left margin of the fr-grid-content
.fb-edit-items { text-decoration: none; display: block; clear: both; position: absolute; left: 2.5em; bottom: .5em }
// Simply styling for file select to just show "x"
#fr-form-group .fb-static-upload {
    background-color: none;
    position: absolute; // show upload UI at the bottom of the cell and remove file upload indicator
    left: 2.5em;
    bottom: .5em;
    .xforms-upload-info { padding: 0 }
    .xforms-upload-size { padding: 0 }
    .xforms-upload-remove { padding: 0 }
}

.fr-grid .fr-grid-td .fb-grid-control-icons img { display: inline }
.fb-label-hint-placeholder,                                                         // Grey color for placeholder "Click here to edit…" so users can distinguish it from an actual value
.fb-label-hint-placeholder .xforms-mock-button { color: #bbb }                      // To take precedence over color set for button's labels in xforms.css
.fr-grid .fr-grid-content .xforms-trigger .xforms-mock-button input,                // Override margin set in form-runner-base.css for buttons in noscript (rendered as input)
.fr-grid .fr-grid-content .xforms-trigger .fb-mock-link input
    { margin: 0 }
.fb-mock-link { color: @darkBlue; text-decoration: underline }                      // Simulate  styling of a link
.xforms-mock-button .xforms-label { margin: 0 }                                     // Override margin set in form-runner-base.css for regular labels
.fb-label-hint-placeholder .fb-mock-link { color: #bbb; text-decoration: none }     // When placeholder shown, don't underline and use grey color, to make it clear this is a placeholder
.fb-mock-link:hover { background-color: @yellow }                                   // Simulated link get yellow background on mouse over to suggest it can be edited

.fr-grid-td .fb-hover { position: relative }                                        // So elements shown on hover can be absolutely positioned relative to the cell
                                                                                    // Necessary as Firefox doesn't support position: relative on table cells (http://goo.gl/Atzi2)

// Column icons
.fr-grid thead .fb-grid-column-toolbar-td {                                         // .fr-grid and thead added to take precedence over YUI's text-align: left
    text-align: center;
    padding-bottom: 2px;                                                            // Padding so that the icon doesn't touch the table border
    height: 22px;                                                                   // Tall enough so that FF doesn't do funny things when the icons are shown upon hover
}
.fb-grid-column-toolbar-td .fb-insert-left { float: left }
.fb-grid-column-toolbar-td .fb-insert-right { float: right }
.fb-grid-column-toolbar-td a { display: none }                                      // By default, don't show the icons at the top of the grid
.fb-grid-column-toolbar-td:hover a,                                                 // Show them when the mouse is specifically over that toolbar td
.fb-grid-column-toolbar-td.fb-hover a                                               // Show them when the mouse is in a cell of the same column; style.coffee adds the .fb-hover
    { display: block }

.fb-selected {                                                                      // Selected cell in grids
    box-shadow: 0 0 10px @darkBlue;                                                 // Highlight current cell with "halo"
}

// Grid
.fr-view .fr-grid {

    .fr-grid-content .xforms-hint:hover,           // .fr-grid-content for label/hint in body
    .fr-grid-th .xforms-label:hover,               // .fr-grid-th for label/hint in thead of a repeat
    .fr-grid-th .xforms-hint:hover,
    .xforms-mock-button span:hover
        { background-color: @yellow }

    // Even if the label or hint is empty, we still want space for 1 line to be reserved
    .fr-grid-content .xforms-label, .fr-grid-content .xforms-hint,                                                      // In regular grid content
    .fr-grid-th .xforms-label, .fr-grid-th .xforms-hint                                                                 // In grid header, for the repeat single line
        { min-height: 20px }                                                                                            // Use min-height instead of height so text wraps if it doesn't fit on 1 line

    .fr-grid-content {
        // Space for the icons to the left and right of the control
        padding-left: 2.5em;
        padding-right: 2.5em;

        // Space for trigger showing the itemset editor and file upload
        &.fb-itemset, &.fb-upload {
            padding-bottom: 2.5em;
        }
        // Inputs for editing the label and hint to take the whole width of the grid content
        .xforms-label input, .xforms-hint input { width: 100% }
    }
}

#fr-view {                                                                                                              // Show disabled hints, i.e. hints with no text, to reserve space for the placeholder
    .fr-grid .xforms-hint.xforms-disabled {                                                                             // Override the #fr-view .xforms-disabled { display: none } in form-runner-base.less
        display: block;
        position: static;                                                                                               // Overrides position: absolute; top: -10000px; left: -10000px in xforms.css
    }
}

.fb-use-toolbar-message, .fb-click-message { display: none; font-size: 70%; color: gray; width: 100%; font-style: italic; text-align: center; margin-top: 2em  }
.fb-selected .fb-use-toolbar-message { display: block }
td:hover .fb-click-message { display: block }
td.fb-selected:hover .fb-click-message { display: none }

.fb-component-icon { display: block }

// Read-only components
.fb-section-component .fr-grid-td { background-image: none; background-color: #F8F8F8; border: solid 1px #F8F8F8 }
.xforms-readonly .xforms-input-input { background-image: none; background-color: #CCCCCC }
.xforms-readonly textarea { background-image: none; background-color: #CCCCCC }

.fr-buttons-placeholder .xforms-output { color: gray }

/* ***** Message **************************************************************************************************** */

.fb-top .fr-messages {
    display: inline;
    background: inherit;
    border: none;
    margin: 0;
    padding: 0;
    clear: none; // override "both" so that IE 7 support for inline-block works
}

.fb-top .fr-messages .fr-message {
    display: -moz-inline-box;
    display: inline-block;
    *zoom: 1; // IE 7 hack
    margin:0.35em 0 0 2em;
    padding: .2em;
    color: white;
    border-color: white;
    border-radius: 3px; -moz-border-radius: 3px; -webkit-border-radius: 3px; -ms-border-radius: 3px
}

.fb-xpath-errors {
    display: block;
    float: left;
    color: orange;
}

/* ***** Layout ***************************************************************************************************** */

#fr-view { margin-left: 0 }

.fb-bottom {
    position: fixed;
    bottom: 0;
    width: 100%;
    .box-sizing(border-box);
    padding: .8em;

    .fr-buttons {
        margin: 0;
    }
}



.fr-container { top: 10px }                                 // override 40px in form-runner-base.css as we don't leave as much as space at the top since the navbar isn't fixed

// Both navbars
.navbar .navbar-inner {
    box-shadow: none;
}

// Top Form Builder navbar only
.fb-navbar {
    margin-bottom: 0;                                       // override 18px in bootstrap.css as the content below the navbar (.fr-top) already as its own padding

    .border-radius(0);                                      // override Boostrap rounded corners

    .fr-language-choice {
        text-shadow: 0 1px 0 @navbarBackgroundHighlight;    // make it look like Boostrap nav links
        margin-left: 15px;
        font-size: inherit;                                 // ovverride FR
    }

    .container {
        width: auto;
        margin-left: 15px;
        margin-right: 15px;
    }
}

// Form navbar only
.fb-main .navbar-inverse .navbar-inner {

    #gradient > .vertical(#222, #444);
    .border-radius(0);

    .fb-language-triggers, .fb-form-settings-trigger {
        margin-top: 8px;
        margin-left: 6px;
    }

    .fr-language-choice {
        margin-right: 0;                                    // ovverride FR
    }
}

/* ***** Other media ************************************************************************************************ */

// This is also used for PDF generation
@media print {
    input { height: 1em }
}
