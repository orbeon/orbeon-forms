<!--
    Copyright (C) 2018 Orbeon, Inc.

    This program is free software; you can redistribute it and/or modify it under the terms of the
    GNU Lesser General Public License as published by the Free Software Foundation; either version
    2.1 of the License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
    without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU Lesser General Public License for more details.

    The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
-->
<xh:html
    xmlns:xh="http://www.w3.org/1999/xhtml"
    xmlns:xxf="http://orbeon.org/oxf/xml/xforms"
    xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
    xmlns:xf="http://www.w3.org/2002/xforms">

    <xh:head>
        <xh:title><xf:output ref="$fr-resources/authentication/login/title"/></xh:title>
        <xh:link rel="stylesheet" href="/apps/fr/style/form-runner-login.css" type="text/css" media="all"/>
        <xf:model id="fr-form-model" xxf:revisit-handling="reload">
            <xf:instance id="login-instance">
                <login>
                    <username/>
                    <password/>
                </login>
            </xf:instance>
            <xf:submission
                id="login-submission"
                method="post"
                resource="/j_security_check"
                serialization="application/x-www-form-urlencoded"
                replace="all"/>
        </xf:model>
    </xh:head>
    <xh:body>
        <fr:view>
            <fr:navbar/>
            <fr:body>
                <fr:grid>
                    <xf:action type="javascript" event="DOMActivate">
                        <xf:param name="username"    value="username"/>
                        <xf:param name="password"    value="password"/>
                        <xf:param name="loginAction" value="concat(xxf:get-request-context-path(), '/j_security_check')"/>
                        <xf:body>
                            ORBEON.fr.private.API.submitLogin(username, password, loginAction);
                        </xf:body>
                    </xf:action>
                    <fr:c x="5" y="1" w="4">
                        <xf:input ref="username">
                            <xf:label ref="$fr-resources/authentication/login/username"/>
                        </xf:input>
                    </fr:c>
                    <fr:c x="5" y="2" w="4">
                        <xf:secret ref="password">
                            <xf:label ref="$fr-resources/authentication/login/password"/>
                        </xf:secret>
                    </fr:c>
                    <fr:c x="5" y="3" w="4">
                        <xf:trigger appearance="xxf:primary">
                            <xf:label ref="$fr-resources/authentication/login/login"/>
                        </xf:trigger>
                    </fr:c>
                </fr:grid>
            </fr:body>
        </fr:view>
    </xh:body>
</xh:html>
